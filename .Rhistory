knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(knitr)
library(kableExtra)
library(dplyr)
#library(rpart)
#library(rpart.plot)
#library(caret)
#read the file
DS <- read.csv("gaming_data.csv")
colnames(DS)
View(DS)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(knitr)
library(kableExtra)
library(dplyr)
#library(rpart)
#library(rpart.plot)
#library(caret)
```
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(knitr)
library(kableExtra)
library(dplyr)
#library(rpart)
#library(rpart.plot)
#library(caret)
#read the file
DS <- read.csv("gaming_data.csv")
colnames(DS)
# 1 Function to compute descriptive metrics
describe_segment <- function(df, segment_name)
{
data.frame(
Segment = segment_name,
Variable = c("playtime", "sessions", "levels", "spending"),
Average = c(mean(df$playtime),
mean(df$sessions),
mean(df$levels),
mean(df$spending)),
StandardDeviation = c(sd(df$playtime),
sd(df$sessions),
sd(df$levels),
sd(df$spending))
)
}
# 2 Premium and Freemium datasets
DS_Premium  <- DS[DS$user_type == "Premium", ]
DS_Freemium <- DS[DS$user_type == "Freemium", ]
# 3 Generate all tables
global_table   <- describe_segment(DS,          "All users")
premium_table  <- describe_segment(DS_Premium,  "Premium")
freemium_table <- describe_segment(DS_Freemium, "Freemium")
# ---- GLOBAL TABLE ----
global_table %>%
kable(format = "html", digits = 2,
caption = "Global - Descriptive Metrics") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>%
column_spec(1, bold = TRUE) %>%
column_spec(2, bold = TRUE) %>%
column_spec(3, color = "blue") %>%
column_spec(4, color = "darkred")
# ---- PREMIUM TABLE ----
premium_table %>%
kable(format = "html", digits = 2,
caption = "Premium Users - Descriptive Metrics") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>%
column_spec(1, bold = TRUE) %>%
column_spec(2, bold = TRUE) %>%
column_spec(3, color = "blue") %>%
column_spec(4, color = "darkred")
# ---- FREEMIUM TABLE ----
freemium_table %>%
kable(format = "html", digits = 2,
caption = "Freemium Users - Descriptive Metrics") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>%
column_spec(1, bold = TRUE) %>%
column_spec(2, bold = TRUE) %>%
column_spec(3, color = "blue") %>%
column_spec(4, color = "darkred")
# ARPU
ARPU <- mean(DS$spending)
# ARPPU
paying_users <- DS[DS$spending > 0,]
ARPPU <- mean(paying_users$spending)
# Conversion Rate
conversion_rate <- nrow(paying_users) / nrow(DS)
# Engagement index per player
DS$engagement_index <- DS$playtime * DS$sessions
# Average Engagement Index
avg_engagement <- mean(DS$engagement_index)
# Results
metrics <- data.frame(
Metric = c("ARPU", "ARPPU", "Conversion Rate", "Average Engagement Index"),
Value = c(ARPU, ARPPU, conversion_rate, avg_engagement)
)
kableExtra::kable(metrics, caption = "Game Performance Metrics")
#1
# Percentage of paying users versus non paying users.
percent_summary <- DS %>%
group_by(user_type) %>%
summarise(count = n()) %>%
mutate(percent = count / sum(count) * 100)
ggplot(percent_summary, aes(x = "", y = percent, fill = user_type)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y") +
geom_text(aes(label = paste0(round(percent,1), "%")),
position = position_stack(vjust = 0.5)) +
labs(title = "Percentage of paying users versus non paying users") +
theme_void()
#2
# Boxplot comparing playtime and engagement of group A vs. group B.
DS <- DS %>%
mutate(engagement = playtime * sessions)
# Boxplot de playtime per grup
ggplot(DS, aes(x = group, y = playtime, fill = group)) +
geom_boxplot() +
labs(title = "Boxplot: Playtime by Group (A vs B)",
x = "Group",
y = "Playtime (minutes)") +
theme_minimal()
#3
# Line plot: Levels completed vs Sessions per Group
ggplot(DS, aes(x = sessions, y = levels, color = group)) +
geom_line() +
geom_point() +
labs(title = "Levels completed vs Sessions per Group",
x = "Number of Sessions",
y = "Average Levels Completed",
color = "Group") +
theme_minimal()
# variables: playtime sessions, levels, friends and skill_score.
DS_Predict_Regression <- DS[, c("sessions", "levels", "friends", "skill_score", "playtime", "spending")]
model <- lm( spending ~ ., DS_Predict_Regression)
summary(model)
# Create a random data frame
random_user <- data.frame(
playtime = 200,
sessions = 10,
levels = 5,
friends =100,
skill_score=60
)
# Predict the spending using the previous model
predict(model, random_user)
# Create a new simulation
playtime_seq <- seq(100,1000,50)
simulation <- data.frame(
playtime = playtime_seq,
sessions = 10,
levels = 5,
friends =100,
skill_score=60
)
simulation$spending<-predict(model, simulation)
print(simulation)
# Create the plot
ggplot(simulation, aes(x = playtime, y = spending))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "red")
model_categorical <- lm(spending ~., DS)
summary(model_categorical)
metrics %>%
kable(caption = "Game Performance Metrics", format = "html", digits = 2, align = "c") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE,
position = "center") %>%
row_spec(0, bold = TRUE, background = "#f2f2f2")
metrics %>%
kable(caption = "Game Performance Metrics", format = "html", digits = 2, align = "c") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
position = "center") %>%
row_spec(0, bold = TRUE, background = "#f2f2f2")
metrics %>%
kable(caption = "Game Performance Metrics", format = "html", digits = 2, align = "c") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE) %>%
row_spec(0, bold = TRUE, background = "#f2f2f2")
# Sample sizes
n_A <- sum(DS$group == "A")
n_B <- sum(DS$group == "B")
# Sample means
mean_A <- mean(DS$playtime[DS$group == "A"])
mean_B <- mean(DS$playtime[DS$group == "B"])
# Sample variances
var_A <- var(DS$playtime[DS$group == "A"])
var_B <- var(DS$playtime[DS$group == "B"])
# Sample sizes
n_A <- sum(DS$group == "A")
n_B <- sum(DS$group == "B")
# Sample means
mean_A <- mean(DS$playtime[DS$group == "A"])
mean_B <- mean(DS$playtime[DS$group == "B"])
# Sample variances
var_A <- var(DS$playtime[DS$group == "A"])
var_B <- var(DS$playtime[DS$group == "B"])
# Observed value
t_obs <- (mean_B - mean_A) / sqrt(var_B/n_B + var_A/n_A)
# Degrees of freedom
df_num <- (var_B/n_B + var_A/n_A)^2
df_den <- ( (var_B/n_B)^2 / (n_B - 1) ) + ( (var_A/n_A)^2 / (n_A - 1) )
df <- df_num / df_den
# Critical t-value (upper tail)
t_crit <- qt(0.95, df)
# p-value
p_val <- 1 - pt(t_obs, df)
#read the file
DS <- read.csv("gaming_data.csv")
colnames(DS)
# Sample sizes
n_A <- sum(DS$group == "A")
n_B <- sum(DS$group == "B")
# Sample means
mean_A <- mean(DS$playtime[DS$group == "A"])
mean_B <- mean(DS$playtime[DS$group == "B"])
# Sample variances
var_A <- var(DS$playtime[DS$group == "A"])
var_B <- var(DS$playtime[DS$group == "B"])
# Observed value
t_obs <- (mean_B - mean_A) / sqrt(var_B/n_B + var_A/n_A)
# Degrees of freedom
df_num <- (var_B/n_B + var_A/n_A)^2
df_den <- ( (var_B/n_B)^2 / (n_B - 1) ) + ( (var_A/n_A)^2 / (n_A - 1) )
df <- df_num / df_den
# Critical t-value (upper tail)
t_crit <- qt(0.95, df)
# p-value
p_val <- 1 - pt(t_obs, df)
